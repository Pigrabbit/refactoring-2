# Chapter 1

프로그램이 잘 작동하는 상황에서 그저 코드가 '지저분하다'는 이유로 불평하는 것은 프로그램의 구조를 너무 미적인 기준으로만 판단하는 건 아닐까? 컴파일러는 코드가 깔끔하든 지저분하든 개의치 않으니 말이다.

하지만 그 코드를 수정하려면 사람이 개입되고, 사람은 코드의 미적 상태에 민감하다.

무엇을 수정할지 찾기 어렵다면 실수를 저질러서 버그가 생길 가능성도 높아진다

> 프로그램이 새로운 기능을 추가하기에 편한 구조가 아니라면, 먼저 기능을 추가하기 쉬운 형태로 리팩터링 하고 나서 원하는 기능을 추가한다

정책이 복잡해질수록 수정할 부분을 찾기 어려워지고 수정 과정에서 실수할 가능성도 커진다

**리팩토링이 필요한 이유는 바로 이러한 변경 때문이다**

잘 작동하고 나중에 변경할 일이 절대 없다면 코드를 현재 상태로 놔둬도 아무런 문제가 없다.
하지만 그러다 다른 사람이 읽고 이해해야 할 일이 생겼는데 로직을 파악하기 어렵다면 뭔가 대책을 마련해야 한다.

## Before get refactoring

리팩터링할 코드 영역을 꼼꼼하게 검사해줄 테스트 코드들부터 마련해야 한다.

> 리팩터링하기 전에 제대로 된 테스트부터 마련한다. 테스트는 반드시 자가진단하도록 만든다.

원하는 내용을 소스코드와 테스트 코드 양쪽에 적어두면, 두 번 다 똑같이 실수하지 않는 한 디버거에 반드시 걸린다.
테스트를 작성하는 데 시간이 좀 걸리지만, 신경 써서 만들어두면 디버깅 시간이 줄어서 전체 작업시간은 오히려 단축된다.

## Extract Method

코드를 분석해서 얻은 정보를 잊지 않으려면 재빨리 코드에 반영해야 한다.
그러면 다음번에 코드르 볼 때, 다시 분석하지 않아도 코드 스스로가 자신이 하는 일이 무엇인지 이야기해줄 것이다.

코드조각을 별도 함수로 추출하는 방식으로 앞서 파악한 정보를 코드에 반영한다.
추출한 함수에는 그 코드가 하는 일을 설명하는 이름을 지어준다.

별도 함수로 빼냈을 때 유효범위를 벗어나는 변수, 즉 새함수에서는 곧바로 사용할 수 없는 변수가 있는지 확인한다.

수정하고 나면 곧바로 컴파일하고 테스트해서 실수한 게 없는지 확인한다. 
아무리 간단한 수정이라도 리팩터링 후에는 항상 테스트하는 습관을 들이는 것이 바람직하다.

이처럼 조금씩 변경하고 매번 테스트하는 것은 리팩터링 절차의 핵심이다.
조금씩 수정하여 피드백 주기를 짧게 가져가는 습관이 재앙을 피하는 길이다.

> 리팩터링은 프로그램 수정을 작은 단계로 나눠 진행한다. 그래서 중간에 실수하더라도 버그를 쉽게 찾을 수 있다.

좋은 코드라면 하는 일이 명확히 드러나야 하며, 이때 변수 이름은 커다란 역할을 한다.
